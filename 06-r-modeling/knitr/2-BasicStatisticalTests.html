<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistical Modeling</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Statistical Modeling
## In R

---




class: center, middle

# Basic Statistical Tests


---
## Outline

+ p-values

+ confidence intervals

+ t-tests

+ chi-square tests

+ simple regression

---
## Five Step Hypothesis Testing Procedure

+ Step 1: State your null and alternate hypothesis. 

+ Step 2: Collect data. 

+ Step 3: Perform a statistical test. 

+ Step 4: Decide whether to reject or fail to reject your null hypothesis. 

+ Step 5: Present your findings.


???

+ Step 1: State your null and alternate hypothesis. 
  + (the prediction that you want to investigate)
  + The alternate hypothesis is usually your initial hypothesis that predicts a relationship between variables. The null hypothesis is a prediction of no relationship between the variables you are interested in.

+ Step 2: Collect data. 
  + For a statistical test to be valid, it is important to perform sampling and collect data in a way that is designed to test your hypothesis. If your data are not representative, then you cannot make statistical inferences about the population you are interested in.

+ Step 3: Perform a statistical test. 
  + There are a variety of statistical tests available, but they are all based on the comparison of within-group variance (how spread out the data is within a category) versus between-group variance (how different the categories are from one another).

+ Step 4: Decide whether to reject or fail to reject your null hypothesis. 
  + Based on the outcome of your statistical test, you will have to decide whether to reject or fail to reject your null hypothesis.
  + In most cases you will use the p-value generated by your statistical test to guide your decision. And in most cases, your predetermined level of significance for rejecting the null hypothesis will be 0.05 – that is, when there is a less than 5% chance that you would see these results if the null hypothesis were true.

+ Step 5: Present your findings.
  + The results of hypothesis testing will be presented in the results and discussion sections of your research paper.

---
## What is a p-value?



---
## What does a confidence interval tell me?

---
## Penguins Data


```r
data(penguins, package = "palmerpenguins")
```

![](images/palmer-penguins.png)

---
## Two-sample independent t-test

**Research Question** Is there a difference in the body mass (g) of penguins between male and female penguins?

.pull-left[
**Data**
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; sex &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; body_mass_g &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3750 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3800 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3250 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

**Numerical Summary**

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; sex &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mean &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; sd &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3862.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 666.2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4545.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 787.6 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
].pull-right[

**Graphical Summary**

![](2-BasicStatisticalTests_files/figure-html/penguins-ttest-boxplot-1.png)&lt;!-- --&gt;

]

---
## Two-sample t-test


```r
help(t.test)
t.test(y ~ x, 
       data = data_name,
       alternative = “two.sided”, 
       mu = 0, 
       paired = FALSE, 
       var.equal = FALSE, 
       conf.level = 0.95)
```

+ **y:** The variable name of the quantitative response.
+ **x:** The variable name of the grouping variable (or treatment).
+ **data:** The name of the data set
+ **alternative:** The alternative hypothesis. Options include “two.sided”, “less”, or “greater.”
+ **mu:** The value assumed to be the true difference in means.
+ **paired:** Whether or not to use a paired t-test.
+ **var.equal:** Whether or not the variances are equal between the two groups.
+ **conf.level:** The confidence level to use for the test.

???

**Test for equal variances**

```r
library(car)
leveneTest(penguins2$body_mass_g, group = penguins2$sex, center = mean)
```

```
## Levene's Test for Homogeneity of Variance (center = mean)
##        Df F value   Pr(&gt;F)   
## group   1  9.3374 0.002428 **
##       331                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
## Two-sample independent t-test

+ *Null:* the mean body mass for female penguins is equal to the mean body mass for male penguins (female - male `\(= 0\)`)
+ *Alternative:* the mean body mass for female penguins is **not** equal to the mean body mass for male penguins (female - male `\(\ne 0\)`)


```r
*penguins_ttest &lt;- t.test(body_mass_g ~ sex, data = penguins2)
penguins_ttest
```


```
## 
## 	Welch Two Sample t-test
## 
## data:  body_mass_g by sex
## t = -8.5545, df = 323.9, p-value = 4.794e-16
## alternative hypothesis: true difference in means between group female and group male is not equal to 0
## 95 percent confidence interval:
##  -840.5783 -526.2453
## sample estimates:
## mean in group female   mean in group male 
##             3862.273             4545.685
```

---
## Two-sample independent t-test (table results)

**Extract specific output**


```r
penguins_ttest$statistic
penguins_ttest$df
penguins_ttest$p.value
```

**Summarize results with `library(broom)`**


```r
install.packages("broom")
library(broom)
*penguins_results &lt;- tidy(penguins_ttest)
penguins_results
```

&lt;div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "&gt;&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate1 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate2 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; parameter &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; conf.low &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; conf.high &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; method &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; alternative &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; -683.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3862.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4545.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -8.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 323.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -840.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -526.2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Welch Two Sample t-test &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; two.sided &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;

---
## Two-sample independent t-test (graphical results)


```r
ggplot(penguins_results, aes(x = NA, y = estimate)) +
  geom_point(size = 2) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  theme_bw() +
  theme(aspect.ratio = 0.5, axis.text.y = element_blank()) +
  xlab("") + ylab("Difference in Body Mass \n (Female - Male)") +
  coord_flip()
```

&lt;img src="2-BasicStatisticalTests_files/figure-html/penguins-ttest-graph-results-1.png" style="display: block; margin: auto;" /&gt;

---
## Two-sample independent t-test (Your turn!)

+ What if you wanted the difference to be male - female? (Hint: use `relevel()`)

+ The default confidence level is 95%, how would you change it to a 90% confidence level? 
  + Does your p-value change?
  + How about your confidence interval?
  
---
## Two-sample independent t-test (Your turn!)
+ What if you wanted the difference to be male - female?


```r
levels(penguins2$sex)
```

```
## [1] "female" "male"
```

```r
*penguins2$sex &lt;- relevel(penguins2$sex, ref = "male")
levels(penguins2$sex)
```

```
## [1] "male"   "female"
```


```r
penguins_ttest2 &lt;- t.test(body_mass_g ~ sex, data = penguins2)
penguins_ttest2
```

&lt;div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "&gt;&lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; estimate &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate1 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; estimate2 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; statistic &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; p.value &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; parameter &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; conf.low &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; conf.high &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; method &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; alternative &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 683.4 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4545.7 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3862.3 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8.6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 323.9 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 526.2 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 840.6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Welch Two Sample t-test &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; two.sided &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;/div&gt;

---
## Two-sample independent t-test (Your turn!)
+ The default confidence level is 95%, how would you change it to a 90% confidence level? 
  + Does your p-value change?
  + How about your confidence interval?


```
## [1] 4.793891e-16
```

```
## [1] 526.2453 840.5783
## attr(,"conf.level")
## [1] 0.95
```


```r
penguins_ttest3 &lt;- t.test(body_mass_g ~ sex, 
                          data = penguins2, 
*                         conf.level = 0.9)
penguins_ttest3$p.value
penguins_ttest3$conf.int
```


```
## [1] 4.793891e-16
```

```
## [1] 551.6295 815.1941
## attr(,"conf.level")
## [1] 0.9
```

---
## Chi-square test of independence

**Research Question** Are island and the species of penguin associated?

.pull-left[
**Data**
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; species &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; island &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adelie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Torgersen &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;
&lt;br&gt;
**Numerical Summary**


```
##            species
## island      Adelie Chinstrap Gentoo
##   Biscoe        44         0    124
##   Dream         56        68      0
##   Torgersen     52         0      0
```

].pull-right[

**Graphical Summary**
 
![](2-BasicStatisticalTests_files/figure-html/penguins-chisq-mosaicplot-1.png)&lt;!-- --&gt;

]

---
## Chi-square test of independence


```r
help("chisq.test")
chisq.test(y ~ x, 
       data = data_name,
       simulate.p.value = FALSE,
       B = 2000)
```

---
## Chi-square test of independence


```r
*chisq.test(penguins3$island, penguins3$species)
```

```
## 
## 	Pearson's Chi-squared test
## 
## data:  penguins3$island and penguins3$species
## X-squared = 299.55, df = 4, p-value &lt; 2.2e-16
```

```r
chisq.test(penguins3$island, penguins3$species, 
*          simulate.p.value = T)
```

```
## 
## 	Pearson's Chi-squared test with simulated p-value (based on 2000 replicates)
## 
## data:  penguins3$island and penguins3$species
## X-squared = 299.55, df = NA, p-value = 0.0004998
```
 
---
## Simple Regression

---
## Main points
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
