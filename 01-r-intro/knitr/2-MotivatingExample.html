<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Motivating Example</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Motivating Example
]

---


## Motivating Example

- Kick off the workshop by exploring a real data set using R!

- Goal: get the flavor of using R for data management and exploration

- Don't worry about understanding all the coding right away

- We will go back and explain how it all works in detail

- Follow along using [2-MotivatingExample.R](../code/2-MotivatingExample.R)

- Tip: Using "#" in your R File to take notes
  + Super important to document your code!

---
## Getting Started

Let's begin by installing and loading `tidyverse`:






This workshop will focus largely on a group of packages that live together under the name `tidyverse`. 

`tidyverse` includes the following well known packages:

- `ggplot2`
- `dplyr`
- `tidyr`
- `readr`
- and more!

---

## Salmonella Shedding Data

- Fecal *Salmonella* shedding recorded over the course of 21 days

- Several **variables** were recorded for each pig at certain time points:

    - Amount of *Salmonella* in feces (log10)
    - Pig weight (kg)
    - Dietary treatment group
    
- **Primary Question**: Do the different dietary treatments affect *Salmonella* shedding?


---
## First look at data in R

Let's use R to look at the top few rows of the *Salmonella* shedding data set. First, we load the data set using `read_csv`:


```r
shed &lt;- read_csv("https://unl-statistics.github.io/R-workshops/01-r-intro/data/daily_shedding.csv")
```

Now, we use the `head` function to look at the first 6 rows of the data:


```
## # A tibble: 6 × 12
##   pignum time_point pig_wei…¹  temp pan_wt wet_wt Dry_w…²
##    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1     77          2        NA  103.   1.02   1.09    1.31
## 2     87          2        NA  104.   1.04   1.02    1.33
## 3    122          2        NA  104.   1.02   0.99    1.11
## 4    160          2        NA  104.   1.09   1       1.36
## 5    191          2        NA  104.   1.03   1.02    1.27
## 6    224          2        NA  103    1.08   1       1.39
## # … with 5 more variables: Dry_weight &lt;dbl&gt;,
## #   percent_drymatter &lt;dbl&gt;, daily_shedding &lt;dbl&gt;,
## #   treatment &lt;chr&gt;, total_shedding &lt;dbl&gt;, and
## #   abbreviated variable names ¹​pig_weight, ²​Dry_wt_pan
```

---
## *Salmonella* Shedding Data: Attributes

How big is this data set, and what types of variables are in each column?


```
## spc_tbl_ [295 × 12] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ pignum           : num [1:295] 77 87 122 160 191 224 337 345 419 458 ...
##  $ time_point       : num [1:295] 2 2 2 2 2 2 2 2 2 2 ...
##  $ pig_weight       : num [1:295] NA NA NA NA NA NA NA NA NA NA ...
##  $ temp             : num [1:295] 103 104 104 104 104 ...
##  $ pan_wt           : num [1:295] 1.02 1.04 1.02 1.09 1.03 1.08 1.03 1.09 1.07 1.04 ...
##  $ wet_wt           : num [1:295] 1.09 1.02 0.99 1 1.02 1 1.02 0.99 1.07 1.06 ...
##  $ Dry_wt_pan       : num [1:295] 1.31 1.33 1.11 1.36 1.27 1.39 1.3 1.24 1.38 1.26 ...
##  $ Dry_weight       : num [1:295] 0.29 0.29 0.09 0.27 0.24 0.31 0.27 0.15 0.31 0.22 ...
##  $ percent_drymatter: num [1:295] 26.61 28.43 9.09 27 23.53 ...
##  $ daily_shedding   : num [1:295] 5.3 5.7 13.22 6.75 5.86 ...
##  $ treatment        : chr [1:295] "control" "control" "control" "control" ...
##  $ total_shedding   : num [1:295] 2.3 2.48 5.74 2.93 2.54 ...
##  - attr(*, "spec")=
##   .. cols(
##   ..   pignum = col_double(),
##   ..   time_point = col_double(),
##   ..   pig_weight = col_double(),
##   ..   temp = col_double(),
##   ..   pan_wt = col_double(),
##   ..   wet_wt = col_double(),
##   ..   Dry_wt_pan = col_double(),
##   ..   Dry_weight = col_double(),
##   ..   percent_drymatter = col_double(),
##   ..   daily_shedding = col_double(),
##   ..   treatment = col_character(),
##   ..   total_shedding = col_double()
##   .. )
##  - attr(*, "problems")=&lt;externalptr&gt;
```

---
## *Salmonella* Shedding: Variables

Let's get a summary of the values for each variable:


```
##      pignum        time_point     pig_weight   
##  Min.   :  6.0   Min.   : 0.0   Min.   : 9.48  
##  1st Qu.:119.0   1st Qu.: 2.0   1st Qu.:16.02  
##  Median :224.0   Median : 7.0   Median :19.78  
##  Mean   :234.7   Mean   : 8.8   Mean   :21.01  
##  3rd Qu.:361.0   3rd Qu.:14.0   3rd Qu.:25.29  
##  Max.   :472.0   Max.   :21.0   Max.   :36.30  
##                                 NA's   :59     
##       temp           pan_wt          wet_wt     
##  Min.   :101.2   Min.   :1.000   Min.   :0.700  
##  1st Qu.:102.4   1st Qu.:1.030   1st Qu.:1.000  
##  Median :102.9   Median :1.050   Median :1.020  
##  Mean   :102.9   Mean   :1.054   Mean   :1.026  
##  3rd Qu.:103.4   3rd Qu.:1.070   3rd Qu.:1.050  
##  Max.   :105.2   Max.   :1.120   Max.   :1.110  
##  NA's   :118     NA's   :122     NA's   :123    
##    Dry_wt_pan      Dry_weight    percent_drymatter
##  Min.   :1.110   Min.   :0.090   Min.   : 9.091   
##  1st Qu.:1.300   1st Qu.:0.250   1st Qu.:24.292   
##  Median :1.320   Median :0.280   Median :26.923   
##  Mean   :1.322   Mean   :0.268   Mean   :26.109   
##  3rd Qu.:1.353   3rd Qu.:0.290   3rd Qu.:28.431   
##  Max.   :1.460   Max.   :0.380   Max.   :36.893   
##  NA's   :123     NA's   :123     NA's   :123      
##  daily_shedding    treatment         total_shedding  
##  Min.   : 0.000   Length:295         Min.   : 0.000  
##  1st Qu.: 0.000   Class :character   1st Qu.: 1.699  
##  Median : 3.912   Mode  :character   Median :13.904  
##  Mean   : 3.765                      Mean   :17.423  
##  3rd Qu.: 5.521                      3rd Qu.:30.893  
##  Max.   :13.218                      Max.   :66.207  
## 
```

---
## Scatterplots

Let's look at the relationship between time point and *Salmonella* shedding.  

![](2-MotivatingExample_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;

---
## More Scatterplots

Color the points by treatment groups

![](2-MotivatingExample_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;

---

## More Scatterplots

Switch to lines for easier reading

![](2-MotivatingExample_files/figure-html/unnamed-chunk-9-1.png)&lt;!-- --&gt;

---
## Even More Plots

Add faceting

![](2-MotivatingExample_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;

---
## Variable Creation and Data Filtering

We will make a new variable in the data: `gain = weight at day 21 - weight at day 0`.

We will then filter the data to only include the final values.


```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    8.22   12.40   14.14   14.16   16.04   18.86
```

---
## Histogram

Let's look distribution of the final shedding values with a histogram

![](2-MotivatingExample_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;

---
## One pig did not shed at all...

Which pig, and what treatment did it receive?


```
## # A tibble: 1 × 7
##   pignum time_point pig_w…¹ daily…² treat…³ total…⁴  gain
##    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1     97         21    24.9       0 RPS           0  12.9
## # … with abbreviated variable names ¹​pig_weight,
## #   ²​daily_shedding, ³​treatment, ⁴​total_shedding
```

---
## Shedding by Treatment

Look at the average cumulative shedding value for each treatment separately



```
## [1] 44.42518
```

```
## # A tibble: 6 × 2
##   treatment med_shed
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 Acid          35.4
## 2 Bglu          37.6
## 3 control       44.4
## 4 RCS           39.4
## 5 RPS           29.1
## 6 Zn+Cu         44.1
```

---
## Statistical Significance

There is a difference, but is it statistically significant?


```
## 
## 	Wilcoxon rank sum exact test
## 
## data:  total_shedding by treatment
## W = 75, p-value = 0.01327
## alternative hypothesis: true location shift is not equal to 0
```

---
## Boxplots

We could compare the cumulative shedding values of each treatment group with a side by side boxplot

![](2-MotivatingExample_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;

---
## Boxplots Again

Alternatively, we could use the original data to compare the daily shedding values of each treatment group with side by side boxplots over time

![](2-MotivatingExample_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;


---
class: inverse

## Your Turn 

Try playing with chunks of code from this session to further investigate the *Salmonella* shedding data:

1. Get a summary of the daily shedding values (use the `shed` data set)

2. Make side by side boxplots of final weight gain by treatment group (use the `final_shed` data set)

3. Compute a Wilcox test for control vs. the "Bglu" treatment group 
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
